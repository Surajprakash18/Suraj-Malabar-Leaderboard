<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MGD Hesaraghatta Dashboard</title>
    <style>
        /* --- CSS STYLES TO MATCH THE "BEFORE" IMAGE --- */
        :root {
            --bg-color: #0a0a0a;
            --card-bg: #141414;
            --text-primary: #ffffff;
            --text-secondary: #a0a0a0;
            
            /* Define the specific team colors from the first image */
            --neon-yellow: #ffea00; /* For Precious */
            --neon-cyan: #00e5ff;   /* For Divine */
            --neon-green: #39ff14;  /* For Mine */
            --neon-red: #ff1744;    /* For Zoul */
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-primary);
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 20px;
            text-transform: uppercase;
        }

        /* --- Header Section --- */
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .header h1 {
            color: var(--neon-cyan);
            font-size: 2.5em;
            margin: 0;
            text-shadow: 0 0 10px var(--neon-cyan);
        }
        .header .sub-title {
            color: var(--neon-yellow);
            font-size: 1em;
            margin: 5px 0;
            letter-spacing: 1px;
        }
        .header .deadline {
            color: var(--neon-red);
            font-size: 1.2em;
            font-weight: bold;
            margin-top: 10px;
        }

        /* --- Main Containers --- */
        .container {
            border: 2px solid var(--neon-cyan);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 0 20px rgba(0, 229, 255, 0.2);
        }
        .section-title {
            text-align: center;
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 25px;
            letter-spacing: 2px;
        }

        /* --- TEAM RACE STANDINGS --- */
        .race-card {
            background-color: var(--card-bg);
            border-radius: 15px;
            padding: 15px 20px;
            margin-bottom: 15px;
            position: relative;
            /* This variable will be set dynamically for each team */
            border-left: 5px solid var(--team-color, var(--text-secondary));
        }

        .team-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .team-name {
            font-size: 1.2em;
            font-weight: bold;
            color: var(--team-color, var(--text-primary));
            display: flex;
            align-items: center;
        }
        .team-name .crown { margin-right: 8px; }
        .manager-name {
            color: var(--text-secondary);
            font-size: 0.8em;
            margin-left: 5px;
            text-transform: none;
        }

        .growth-stat {
            font-size: 0.9em;
            font-weight: bold;
            margin-left: 10px;
        }
        .text-green { color: var(--neon-green); }
        .text-red { color: var(--neon-red); }

        .team-score {
            font-size: 1.8em;
            font-weight: bold;
            color: var(--team-color, var(--text-primary));
        }

        /* --- Progress Bar (The biggest fix) --- */
        .progress-track {
            background-color: #2a2a2a;
            height: 25px;
            border-radius: 12.5px;
            overflow: hidden;
            position: relative;
        }
        .progress-fill {
            height: 100%;
            /* Use the dynamic team color for the bar */
            background-color: var(--team-color, var(--text-secondary));
            border-radius: 12.5px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 5px;
            transition: width 1s ease-in-out;
        }
        .progress-icon {
            font-size: 1.2em;
            line-height: 1;
        }

        /* --- Team-Specific Color Classes --- */
        .team-precious { --team-color: var(--neon-yellow); }
        .team-divine { --team-color: var(--neon-cyan); }
        .team-mine { --team-color: var(--neon-green); }
        .team-zoul { --team-color: var(--neon-red); }


        /* --- STAFF LEADERBOARD --- */
        .staff-card {
            background-color: var(--card-bg);
            border-radius: 15px;
            padding: 15px 20px;
            margin-bottom: 10px;
            display: flex;
            flex-direction: column;
            position: relative;
            border: 1px solid #333;
        }
        
        .staff-tag {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.7em;
            font-weight: bold;
            margin-bottom: 5px;
            color: var(--bg-color);
            /* Default, will be overridden by team class */
            background-color: var(--text-secondary); 
        }

        .staff-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .staff-name {
            font-size: 1.3em;
            font-weight: bold;
            color: var(--team-color, var(--text-primary));
            display: flex;
            align-items: center;
        }
        .staff-name .crown { margin-right: 8px; }
        
        .staff-rank {
            background-color: #333;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.8em;
        }

        .staff-stats {
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
            font-size: 0.9em;
            font-weight: bold;
        }
        .achievement { color: var(--text-primary); }


        /* --- Ticker --- */
        .ticker-wrap {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            overflow: hidden;
            height: 30px;
            background-color: rgba(0, 229, 255, 0.1);
            border-top: 1px solid var(--neon-cyan);
            display: flex;
            align-items: center;
        }
        .ticker {
            white-space: nowrap;
            padding-left: 100%;
            animation: ticker 20s linear infinite;
            color: var(--neon-cyan);
            font-weight: bold;
        }
        @keyframes ticker {
            0% { transform: translate3d(0, 0, 0); }
            100% { transform: translate3d(-100%, 0, 0); }
        }
    </style>
</head>
<body>

    <div class="header">
        <h1>MGD Hesaraghatta</h1>
        <div class="sub-title">Managed by Suraj Prakash</div>
        <div class="deadline">Deadline: 31 Days Pending</div>
    </div>

    <div class="container">
        <div class="section-title">Team Race Standings</div>
        <div id="team-container">
            </div>
    </div>

    <div class="container">
        <div class="section-title">Staff Leaderboard</div>
        <div id="staff-container">
            </div>
    </div>

    <div class="ticker-wrap">
        <div class="ticker" id="ticker-text">
            Loading data...
        </div>
    </div>


    <script>
        // --- CONFIGURATION ---
        // REPLACE WITH YOUR ACTUAL GOOGLE SHEET CSV URL
        const SHEET_CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vS6tzd7SDpOQ6zHwIGlxNBRFGEG-62iLWa2wMyGyFgjxAWQC3KxP_qBicWEWuBaMsCz1Ydeq-im64_b/pub?gid=0&single=true&output=csv';
        
        // --- MAIN FUNCTION TO FETCH AND UPDATE DATA ---
        async function updateDashboard() {
            try {
                const response = await fetch(SHEET_CSV_URL);
                const data = await response.text();
                
                // Parse CSV data (assumes header in row 1)
                const rows = data.split('\n').slice(1);
                const teams = [];
                const staff = [];

                // --- Data Processing Loop ---
                // Adjust column indices [0], [1], etc., if your sheet is different.
                // Assumed structure: Type | Name | Manager/Sub | Current% | Previous% | Icon
                rows.forEach(row => {
                    const cols = row.split(',');
                    if (cols.length < 5) return; // Skip empty rows

                    const type = cols[0].trim().toLowerCase();
                    const name = cols[1].trim();
                    // Create a CSS-friendly class name from the team name (e.g., "Precious" -> "team-precious")
                    const teamClass = 'team-' + name.toLowerCase().replace(/\s+/g, '-');

                    const entry = {
                        name: name,
                        sub: cols[2].trim(),
                        current: parseFloat(cols[3]),
                        previous: parseFloat(cols[4]),
                        icon: cols[5] ? cols[5].trim() : '',
                        teamClass: teamClass
                    };

                    if (type === 'team') {
                        teams.push(entry);
                    } else if (type === 'staff') {
                        // For staff, we can use the first column as their team affiliation if needed
                        entry.teamName = cols[0].trim();
                        entry.teamClass = 'team-' + entry.teamName.toLowerCase().replace(/\s+/g, '-');
                        staff.push(entry);
                    }
                });

                // --- Render Teams ---
                teams.sort((a, b) => b.current - a.current); // Sort by current score
                
                const teamHtml = teams.map((team, index) => {
                    const growth = team.current - team.previous;
                    const growthClass = growth > 0 ? 'text-green' : 'text-red';
                    const growthSign = growth > 0 ? '+' : '';
                    const crown = index === 0 ? 'ðŸ‘‘' : ''; // Add crown to leader

                    // The `team.teamClass` here is what applies the specific color (yellow, cyan, etc.)
                    return `
                        <div class="race-card ${team.teamClass}">
                            <div class="team-header">
                                <div class="team-name">
                                    <span class="crown">${crown}</span> ${team.name} 
                                    <span class="manager-name">(${team.sub})</span>
                                    <span class="growth-stat ${growthClass}">${growthSign}${growth}%</span>
                                </div>
                                <div class="team-score">${team.current}%</div>
                            </div>
                            <div class="progress-track">
                                <div class="progress-fill" style="width: ${team.current}%;">
                                    <span class="progress-icon">${team.icon}</span>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
                document.getElementById('team-container').innerHTML = teamHtml;

                // --- Render Staff ---
                staff.sort((a, b) => b.current - a.current); // Sort by current score

                const staffHtml = staff.map((person, index) => {
                    const growth = person.current - person.previous;
                    const growthClass = growth > 0 ? 'text-green' : 'text-red';
                    const growthSign = growth > 0 ? '+' : '';
                    const crown = index === 0 ? 'ðŸ‘‘' : '';
                    
                    // Apply team color to staff card as well
                    return `
                        <div class="staff-card ${person.teamClass}">
                            <div class="staff-tag" style="background-color: var(--team-color)">${person.teamName}</div>
                            <div class="staff-info">
                                <div class="staff-name">
                                    <span class="crown">${crown}</span> ${person.name}
                                </div>
                                <div class="staff-rank">#${index + 1}</div>
                            </div>
                            <div class="staff-stats">
                                <span class="${growthClass}">${growthSign}${growth}% GROWTH</span>
                                <span class="achievement">${person.current}% ACHIEVED</span>
                            </div>
                        </div>
                    `;
                }).join('');
                document.getElementById('staff-container').innerHTML = staffHtml;

                // --- Update Ticker ---
                const leader = teams.length > 0 ? teams[0] : {name: 'N/A', current: 0};
                const tickerText = `Team ${leader.name} is leading the race at ${leader.current}%! | Keep pushing for the final deadline! | MGD Hesaraghatta`;
                document.getElementById('ticker-text').textContent = tickerText;

            } catch (error) {
                console.error('Error fetching or parsing data:', error);
                document.getElementById('ticker-text').textContent = 'Error loading data. Please check the connection.';
            }
        }

        // Initial call and setup auto-refresh every 30 seconds
        updateDashboard();
        setInterval(updateDashboard, 30000);

    </script>
</body>
</html>
