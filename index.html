<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MGD Hesaraghatta v37.6</title>
    <style>
        :root {
            --bg-black: #050505;
            --card-bg: #121317;
            --precious: #ff00ff; /* Neon Magenta for Precious */
            --divine: #00e5ff;   /* Neon Cyan for Divine */
            --mine: #ffffff;     /* White for Mine */
            --zoul: #ff8c00;     /* Neon Orange for Zoul */
            --neon-green-glow: #39ff14;
            --neon-red-glow: #ff0000;
            --neon-yellow: #ffff00;
            --light-blue: #00ccff;
        }

        body { 
            background-color: var(--bg-black); 
            color: white; 
            font-family: 'Segoe UI', sans-serif; 
            margin: 0; 
            padding: 15px; 
            text-transform: uppercase;
        }

        /* NEON GLOW EFFECTS */
        .neon-glow { text-shadow: 0 0 10px currentColor; }
        .critical-glow-red { border: 2px solid var(--neon-red-glow) !important; box-shadow: 0 0 25px var(--neon-red-glow) !important; }
        
        @keyframes blinker { 50% { opacity: 0; } }
        .blinking-warning { animation: blinker 0.8s linear infinite; color: var(--neon-red-glow); font-size: 14px; }

        .header { text-align: center; margin-bottom: 25px; }
        .main-title { color: var(--divine); font-size: 28px; font-weight: 900; letter-spacing: 2px; text-shadow: 0 0 15px var(--divine); margin: 0; }
        .sub-title { color: var(--precious); font-size: 14px; margin: 5px 0; text-shadow: 0 0 5px var(--precious); }
        .deadline { color: var(--neon-red-glow); font-weight: bold; font-size: 18px; text-shadow: 0 0 10px var(--neon-red-glow); }

        .outer-box { border: 2px solid var(--divine); border-radius: 20px; padding: 20px; margin-bottom: 25px; box-shadow: 0 0 15px rgba(0, 229, 255, 0.2); }
        .section-title { text-align: center; font-weight: 900; font-size: 20px; margin-bottom: 20px; letter-spacing: 2px; }

        /* TOP PART: TEAM RACING */
        .race-card { background: var(--card-bg); border-radius: 12px; padding: 15px; margin-bottom: 15px; border: 1px solid #333; position: relative; }
        .race-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
        .race-name { font-size: 20px; font-weight: 900; }
        .race-pct { font-size: 26px; font-weight: 900; }
        .race-track { background: #111; height: 32px; border-radius: 16px; overflow: hidden; position: relative; border: 1px solid #444; }
        .race-fill { height: 100%; border-radius: 16px; position: relative; transition: width 1s; }
        .race-icon { position: absolute; right: -5px; top: 50%; transform: translateY(-50%); font-size: 28px; filter: drop-shadow(0 0 5px white); }

        /* BOTTOM PART: STAFF GRID */
        .staff-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap: 15px; }
        .staff-card { background: var(--card-bg); border-radius: 10px; padding: 12px; border: 1px solid #222; position: relative; transition: 0.3s; }
        .staff-tag { display: inline-block; font-size: 10px; font-weight: 900; padding: 2px 8px; border-radius: 3px; color: black; margin-bottom: 8px; }
        .staff-name { font-size: 18px; font-weight: 900; margin-bottom: 6px; }
        .staff-stats { display: flex; justify-content: space-between; font-size: 10px; font-weight: bold; margin-bottom: 8px; }
        .staff-bar { background: #111; height: 8px; border-radius: 4px; width: 100%; overflow: hidden; }
        .staff-fill { height: 100%; transition: width 1s; }

        /* CROWN */
        @keyframes crown-rotate { 0% { transform: rotateY(0deg); } 100% { transform: rotateY(360deg); } }
        .rotating-crown { display: inline-block; animation: crown-rotate 3s linear infinite; perspective: 1000px; margin-right: 8px; }

        /* TEAM SPECIFIC BG */
        .PRECIOUS-bg { background: var(--precious); }
        .DIVINE-bg { background: var(--divine); }
        .MINE-bg { background: var(--mine); }
        .ZOUL-bg { background: var(--zoul); }

        /* TICKER */
        .ticker { background: #000; border-top: 2px solid var(--divine); color: var(--divine); position: fixed; bottom: 0; left: 0; width: 100%; padding: 10px; font-weight: bold; overflow: hidden; z-index: 1000; }
        .ticker-move { display: inline-block; white-space: nowrap; animation: move 25s linear infinite; }
        @keyframes move { from { transform: translateX(100%); } to { transform: translateX(-100%); } }
    </style>
</head>
<body>

    <div class="header">
        <h1 class="main-title">MGD HESARAGHATTA</h1>
        <div class="sub-title">MANAGED BY SURAJ PRAKASH</div>
        <div class="deadline">DEADLINE: 31 DAYS PENDING</div>
    </div>

    <div class="outer-box">
        <div class="section-title">TEAM RACE STANDINGS</div>
        <div id="team-racing"></div>
    </div>

    <div class="outer-box">
        <div class="section-title">STAFF LEADERBOARD</div>
        <div id="staff-leaderboard" class="staff-grid"></div>
    </div>

    <div class="ticker">
        <div class="ticker-move" id="ticker-text">CONNECTING TO MGD HUB...</div>
    </div>

    <script>
        const SHEET_CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vS6tzd7SDpOQ6zHwIGlxNBRFGEG-62iLWa2wMyGyFgjxAWQC3KxP_qBicWEWuBaMsCz1Ydeq-im64_b/pub?gid=0&single=true&output=csv';

        const getAchieveColor = (v) => {
            if (v < 15) return "#ff0000"; // Dark Neon Red
            if (v < 50) return "#ffff00"; // Neon Yellow
            if (v < 75) return "#00ccff"; // Light Blue
            return "#39ff14"; // Neon Green
        };

        const getTeamColor = (name) => {
            const n = name.toUpperCase();
            if(n.includes('PRECIOUS')) return 'var(--precious)';
            if(n.includes('DIVINE')) return 'var(--divine)';
            if(n.includes('MINE')) return 'var(--mine)';
            if(n.includes('ZOUL')) return 'var(--zoul)';
            return '#fff';
        };

        async function updateDashboard() {
            try {
                const response = await fetch(SHEET_CSV_URL);
                const data = await response.text();
                const rows = data.split('\n').slice(1);
                
                let teams = [];
                let staff = [];

                rows.forEach(row => {
                    const cols = row.split(',');
                    const entry = {
                        type: cols[0]?.trim().toLowerCase(),
                        name: cols[1]?.trim(),
                        sub: cols[2]?.trim().toUpperCase(),
                        curr: parseFloat(cols[3]) || 0,
                        prev: parseFloat(cols[4]) || 0,
                        icon: cols[5]?.trim() || 'üèéÔ∏è',
                        lastRank: parseInt(cols[6]) || 0
                    };
                    if(entry.type === 'team') teams.push(entry);
                    else if(entry.type === 'staff') staff.push(entry);
                });

                // IDENTIFY LOWEST TEAM
                teams.sort((a,b) => b.curr - a.curr);
                const lowestTeamScore = teams.length ? Math.min(...teams.map(t => t.curr)) : 0;

                // RENDER TEAMS
                document.getElementById('team-racing').innerHTML = teams.map((t, i) => {
                    const growth = t.curr - t.prev;
                    const growthCol = growth > 0 ? "var(--neon-green-glow)" : "var(--neon-red-glow)";
                    const teamColor = getTeamColor(t.name);
                    const isLowest = t.curr === lowestTeamScore;

                    return `
                    <div class="race-card ${isLowest ? 'critical-glow-red' : ''}">
                        <div class="race-header">
                            <div class="race-name" style="color:${teamColor}">${isLowest ? '<span class="blinking-warning">‚ö†Ô∏è</span>' : ''}${i === 0 ? '<span class="rotating-crown">üëë</span>' : ''} ${t.name} <span style="font-size:12px; color:#888;">(${t.sub})</span> <span class="neon-glow" style="color:${growthCol}; font-size:12px; margin-left:10px;">${growth > 0 ? '+' : ''}${growth.toFixed(0)}%</span></div>
                            <div class="race-pct neon-glow" style="color: ${teamColor}">${t.curr}%</div>
                        </div>
                        <div class="race-track">
                            <div class="race-fill" style="width: ${t.curr}%; background: ${teamColor}; box-shadow: 0 0 15px ${teamColor}">
                                <span class="race-icon">${t.icon}</span>
                            </div>
                        </div>
                    </div>
                `}).join('');

                // RENDER STAFF
                staff.sort((a,b) => b.curr - a.curr);
                document.getElementById('staff-leaderboard').innerHTML = staff.map((s, i) => {
                    const growth = s.curr - s.prev;
                    const growthCol = growth > 0 ? "var(--neon-green-glow)" : "var(--neon-red-glow)";
                    const barCol = getAchieveColor(s.curr);
                    const teamColor = getTeamColor(s.sub);
                    const isCritical = s.curr < 15;
                    const isWarning = s.curr < 30;
                    const currentRank = i + 1;
                    
                    let trendIcon = '';
                    if (s.lastRank && currentRank < s.lastRank) trendIcon = '<span style="color:var(--neon-green-glow)">‚¨ÜÔ∏è</span>';
                    else if (s.lastRank && currentRank > s.lastRank) trendIcon = '<span style="color:var(--neon-red-glow)">‚¨áÔ∏è</span>';

                    return `
                        <div class="staff-card ${isCritical ? 'critical-glow-red' : ''}">
                            <div class="staff-tag ${s.sub}-bg">${s.sub}</div>
                            <div class="staff-name" style="color:${teamColor}">${isWarning ? '<span class="blinking-warning">‚ö†Ô∏è</span>' : ''}${i === 0 ? '<span class="rotating-crown">üëë</span>' : ''}${s.name}</div>
                            <div class="staff-stats">
                                <span class="neon-glow" style="color:${growthCol}">${growth > 0 ? '+' : ''}${growth.toFixed(0)}% GROWTH</span>
                                <span style="color:#eee">${s.curr}% ACHIEVED</span>
                            </div>
                            <div class="staff-bar"><div class="staff-fill" style="width: ${Math.min(s.curr, 100)}%; background: ${barCol}; box-shadow: 0 0 10px ${barCol}"></div></div>
                            <div class="rank-badge">${trendIcon} #${currentRank}</div>
                        </div>
                    `;
                }).join('');

                // TICKER
                const tP = teams.find(t => t.name === 'PRECIOUS') || {curr:0, icon:'üèéÔ∏è'};
                const tD = teams.find(t => t.name === 'DIVINE') || {curr:0, icon:'üèçÔ∏è'};
                const tM = teams.find(t => t.name === 'MINE') || {curr:0, icon:'üèÉ'};
                const tZ = teams.find(t => t.name === 'ZOUL') || {curr:0, icon:'üö∂'};
                const topS = staff[0] || {name:'N/A', curr:0};

                document.getElementById('ticker-text').innerText = 
                    `Team Precious ${tP.icon} leading at ${tP.curr}% | Team Divine ${tD.icon} at ${tD.curr}% | Team Mine ${tM.icon} at ${tM.curr}% | Team Zoul ${tZ.icon} at ${tZ.curr}% | ${topS.name} Star Performer at ${topS.curr}% | managed by Suraj Prakash, V37.2`;

            } catch (e) { console.error("Sync Error", e); }
        }

        setInterval(updateDashboard, 30000);
        updateDashboard();
    </script>
</body>
</html>
